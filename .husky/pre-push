#!/usr/bin/env sh

echo "ğŸ” Running pre-push checks..."

# Backend checks
echo "ğŸ¦€ Running Rust checks..."

# Cargo clippy
echo "ğŸ”§ Running clippy..."
cargo clippy --all-targets --all-features -- -D warnings
if [ $? -ne 0 ]; then
  echo "âŒ Clippy failed"
  exit 1
fi

# Cargo test
echo "ğŸ§ª Running tests..."
cargo test
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed"
  exit 1
fi

# Check for uncommitted changes
if ! git diff --quiet || ! git diff --cached --quiet; then
  echo "âŒ You have uncommitted changes. Please commit or stash them before pushing."
  exit 1
fi

echo "âœ… All pre-push checks passed!"